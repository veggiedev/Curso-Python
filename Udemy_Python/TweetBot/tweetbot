import random
import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.common.exceptions import NoSuchElementException
from selenium.common.exceptions import ElementClickInterceptedException
from selenium.webdriver.common.keys import Keys


my_hashtags = ['anime', 'girl', 'altgirl', 'gothgirl', 'cosplay', 'cawsplay', 'kimetsunoyaiba', 'naruto',
'cosplayer', 'cosplaygirl', 'cosplayers', 'cosplaying', 'cosplayersofinstagram', 'cosplaymodel', 'cosplays', 
'cosplayphotography', 'cosplaygirl', 'cosplaylife', 'cosplaymakeup', 'cosplaywip', 'cosplayworld', 
'cosplayerofinstagram', 'cosplayprogress', 'cosplayergirl', 'cosplayphoto', 'cosplayselfie', 'cosplayboy',
'cosplaybabe', 'cosplayprop', 'cosplaywig', 'cosplaylove', 'cosplayphotoshoot', 'cosplayphotographer', 
'cosplaylover', 'cosplaycouple', 'cosplaycomparison', 'cosplaytest', 'cosplaysky', 'cosplayfun', 
'cosplayingwhileblack', 'cosplayguy', 'cosplayprops', 'cosplayvscharacter', 'cosplaygoals', 'cosplayboudoir', 
'cosplaybrasil', 'cosplayindonesia', 'cosplayoftheday', 'cosplayanime', 'cosplayersofig', 'cosplaybabes', 
'cosplaygirlsofinstagram', 'cosplayfitness', 'CosPlaystuff', 'cosplaycostume', 'cosplayofinstagram', 
'cosplaycommunity', 'cosplayconnectionbabe', 'animegirl', 'AnimeArt', 'animedrawing', 'animes', 'animelover', 
'animefan', 'animelove', 'animeworld', 'animegirls', 'animememe', 'animememes', 'animeedit', 'animecosplay', 
'animedraw', 'animeartist', 'animeedits', 'animestyle', 'animekawaii', 'animelife', 'animecouple', 'animefacts', 
'animefreak', 'animemanga', 'animefanart', 'animelover', 'animeislife', 'animeguy', 'animeartshelp', 
'animeaccount', 'animeamv', 'animequotes', 'animefans', 'animeotaku', 'animesketch', 'animeshop', 'Animecute', 
'animeforever', 'Animeindo', 'animeartwork', 'animebreath', 'animepic', 'animeartassistant', 'animestore', 
'animequote', 'Animerp', 'animefact', ]

search_hashtags = ['girl', 'girls', 'girlswholift', 'girly', 'GirlBoss', 'girlpower', 'girlfriend', 
'girlswithtattoos', 'girlswithmuscle','GirlsThatLift', 'girlswithpiercings', 'girlsnight', 
'girlswhosquat', 'girlswithink', 'girlswithmuscles', 'girlgamer', 'girlsnightout', 'girlsgeneration', 
'girlstrip', 'girlswholikegirls', 'girlswhokissgirls', 'girlfashion', 'girlsday', 'girlfriends', 
'girlsfashion', 'GirlsWhoTravel', 'girlgains', 'GirlyThings', 'GirlsWhoWorkout', 'girlswithabs',
'cats', 'catsofinstagram', 'catstagram', 'catsagram', 'catsofig', 'catsofworld', 'CatsOfInsta',
'catslover', 'catsoninstagram', 'catslife', 'catsgram', 'catselfie', 'catslovers', 'catsoftheday',
'catskill', 'catsrule', 'catsoftheworld', 'catsfollowers', 'catstocker', 'catsanddog',
'catsofday', 'Catsuit', 'catsofinstgram', 'catsareawesome', 'catsdaily', 'catsworld', 'catsnet',
'catsloversworld', 'catslove', 'catsarelife', 'anime', 'girl', 'altgirl', 'gothgirl', 'cosplay', 'cawsplay', 
'cosplayer', 'cosplaygirl', 'cosplayers', 'cosplaying', 'cosplayersofinstagram', 'cosplaymodel', 'cosplays', 
'cosplayphotography', 'cosplaygirl', 'cosplaylife', 'cosplaymakeup', 'cosplaywip', 'cosplayworld', 
'cosplayerofinstagram', 'cosplayprogress', 'cosplayergirl', 'cosplayphoto', 'cosplayselfie', 'cosplayboy',
'cosplaybabe', 'cosplayprop', 'cosplaywig', 'cosplaylove', 'cosplayphotoshoot', 'cosplayphotographer', 
'cosplaylover', 'cosplaycouple', 'cosplaycomparison', 'cosplaytest', 'cosplaysky', 'cosplayfun', 
'cosplayingwhileblack', 'cosplayguy', 'cosplayprops', 'cosplayvscharacter', 'cosplaygoals', 'cosplayboudoir', 
'cosplaybrasil', 'cosplayindonesia', 'cosplayoftheday', 'cosplayanime', 'cosplayersofig', 'cosplaybabes', 
'cosplaygirlsofinstagram', 'cosplayfitness', 'CosPlaystuff', 'cosplaycostume', 'cosplayofinstagram', 
'cosplaycommunity', 'cosplayconnectionbabe', 'animegirl', 'AnimeArt', 'animedrawing', 'animes', 'animelover', 
'animefan', 'animelove', 'animeworld', 'animegirls', 'animememe', 'animememes', 'animeedit', 'animecosplay', 
'animedraw', 'animeartist', 'animeedits', 'animestyle', 'animekawaii', 'animelife', 'animecouple', 'animefacts', 
'animefreak', 'animemanga', 'animefanart', 'animelover', 'animeislife', 'animeguy', 'animeartshelp', 
'animeaccount', 'animeamv', 'animequotes', 'animefans', 'animeotaku', 'animesketch', 'animeshop', 'Animecute', 
'animeforever', 'Animeindo', 'animeartwork', 'animebreath', 'animepic', 'animeartassistant', 'animestore', 
'animequote', 'Animerp', 'animefact', 'model', 'models', 'Modeling', 'modelo', 'modellife', 'modelling', 
'modelagency', 'Modelos', 'modelphotography', 'modelsearch', 'ModelStatus', 'modelingagency', 'modelfitness', 
'ModelsWanted', 'modelshoot', 'modella', 'modelmanagement', 'modelscout', 'modeltest', 'modelindonesia', 
'modele', 'modelife', 'modelmayhem', 'modelgirl', 'modell', 'modelslife', 'modelkids', 'modelcall' , 
'modelpose', 'ModelOfTheDay', 'kimetsunoyaiba', 'naruto', 'latina', 'latinas', 'latinamerica', 'latinasbelike',
 'latinablogger', 'latinAMAs', 'latinamerican', 'latinagirl', 'latinamericanart', 'latinabloggers', 
 'latinasexy', 'latinactor', 'latinartist', 'latinaboss', 'latinamom', 'latinasdoitbetter', 'latinastyle', 
 'latinafeet', 'latinapower', 'latinamodel', 'latinabooty', 'latinart', 'latinagirls', 'LatinAmas2017', 
 'latinabeauty', 'latinaequalpay', 'latinastrong', 'LatinaArtist', 'latinasaram', 'latinahair']


comments = ["Nice!!!", "That's awesome!", "Love it‚ù§Ô∏è‚Ää‚ù§Ô∏è‚Ää‚ù§Ô∏è", "‚ù§Ô∏è‚Ää‚ù§Ô∏è‚Ää‚ù§Ô∏è‚Ää‚ù§Ô∏è‚Ää‚ù§Ô∏è", "üòç‚Ääüòç‚Ääüòç‚Ääüòç‚Ää", "Wooow!", 
"Oh yeah!", "Grrrrrr üòª‚Ääüòª‚Ääüòª‚Ääüòª‚Ää", "Love it!", "So cool!!!", "OMG ‚Ääüòç", "That looks amazin!", "OMG I love it!", 
 "Grrrrrr", "Me encanta!", "Love it so much", "That is wonderful", "Yeah!!",]

likes = 0
bot_on = True
used_hashtags = []
comments = []
following = []
followers = []
driver = webdriver.Firefox()
driver.get("https://twitter.com")
driver.set_window_size(1280, 1440)
time.sleep(2)

try:
    signin = driver.find_element(By.XPATH, "//a[@data-testid='login']")
    signin.click()     
except NoSuchElementException:
        time.sleep(4)
        print('exception raised')
        alt_signin = driver.find_element(By.XPATH, "//a[@data-testid='loginButton']")
        alt_signin.click()

time.sleep(4)
email = input("Enter email address: ")

signin_email = driver.find_element(By.XPATH, "//input[@autocomplete='username']")
signin_email.send_keys(email)
next_button = driver.find_element(By.XPATH, "//*[contains(text(), 'Next')]")
next_button.click()
try:
    password = input('Please, enter password: ')
    signin_pwd = driver.find_element(By.XPATH, "//input[@type='password']")
    signin_pwd.send_keys(password)
    next_button = driver.find_element(By.XPATH, "//*[contains(text(), 'Log in')]")
    next_button.click()
    time.sleep(5)
except NoSuchElementException:
    print('Exception Raised for unusual behaviour')


username = input("Enter twitter name: ")
time.sleep(2)
username_entry = driver.find_element(By.XPATH, "//input[@data-testid='ocfEnterTextTextInput']")
username_entry.send_keys(username)
time.sleep(2)
username_next = driver.find_element(By.XPATH, "//*[contains(text(), 'Next')]")
username_next.click()
time.sleep(3)
signin_pwd = driver.find_element(By.XPATH, "//input[@type='password']")
signin_pwd.send_keys(password)
next_button = driver.find_element(By.XPATH, "//div[@data-testid='LoginForm_Login_Button']")
next_button.click()
time.sleep(2)
retweets = 0
search = driver.find_element(By.XPATH, "//a[@data-testid='AppTabBar_Explore_Link']")
search.click()
print('Loading search page...')

while bot_on == True:
    # gererate random hashtag from list
    random_hashtag = random.choice(search_hashtags)
    # make a search every time all loaded content has been liked
    if random_hashtag not in used_hashtags:
            used_hashtags.append(random_hashtag)
            search_box = driver.find_element(By.XPATH, "//input[@data-testid='SearchBox_Search_Input']")
            search_box.send_keys(random_hashtag)
            search_box.send_keys(Keys.ENTER)
            print("Making a new search, please wait.")
            time.sleep(3)
            # get like element by xpath
            feed_likes = driver.find_elements(By.XPATH, "//div[@data-testid='like']")
            time.sleep(2)
            # print feed like elements

            for like in feed_likes:
                try:
                    time.sleep(2)
                    likes += 1
                    print(f'Number of likes= {likes}')
                    like.click()
                    driver.execute_script("arguments[0].scrollIntoView();", like)
                    time.sleep(2)
                except ElementClickInterceptedException:
                    # driver.execute_script("arguments[0].scrollIntoView();", like)
                    continue
                except NoSuchElementException:
                    # driver.execute_script("arguments[0].scrollIntoView();", like)
                    continue
                try:
                    time.sleep(2)
                    feed_retweet = driver.find_elements(By.XPATH, "//div[@data-testid='retweet']")
                    for retweet_element in feed_retweet:
                        retweet_element.click() 
                        retweet = driver.find_element(By.XPATH, "//div[@data-testid='retweetConfirm']")
                        retweet.click()
                        retweets += 1
                        print(f'Number of retweets = {retweets}')   
                    time.sleep(2)
                except ElementClickInterceptedException:
                    driver.execute_script("arguments[0].scrollIntoView();", retweet_element)
                    continue
            
            search_box = driver.find_element(By.XPATH, "//input[@data-testid='SearchBox_Search_Input']")
            search_box.click()
            clear_button = driver.find_element(By.XPATH, "//div[@data-testid='clearButton']")
            clear_button.click()

    else:
        random_hashtag = random.choice(search_hashtags)
        print("This hashtag is already been used, startign new search...")
        used_hashtags.append(random_hashtag)        
        search_box = driver.find_element(By.XPATH, "//input[@data-testid='SearchBox_Search_Input']")
        search_box.send_keys(random_hashtag)
        search_box.send_keys(Keys.ENTER)
        print("Making a new search, please wait.")
        time.sleep(3)
        # get like element by xpath
        feed_likes = driver.find_elements(By.XPATH, "//div[@data-testid='like']")
        time.sleep(2)

        for like in feed_likes:
            try:
                time.sleep(2)
                feed_retweet = driver.find_elements(By.XPATH, "//div[@data-testid='retweet']")
                for retweet_element in feed_retweet:
                    retweet_element.click() 
                    retweet = driver.find_element(By.XPATH, "//div[@data-testid='retweetConfirm']")
                    retweet.click()
                    retweets += 1
                    print(f'Number of retweets = {retweets}') 
                time.sleep(2)
            except ElementClickInterceptedException:
                driver.execute_script("arguments[0].scrollIntoView();", retweet_element)
                continue 
        search_box = driver.find_element(By.XPATH, "//input[@data-testid='SearchBox_Search_Input']")
        search_box.click()
        clear_button = driver.find_element(By.XPATH, "//div[@data-testid='clearButton']")
        clear_button.click()
